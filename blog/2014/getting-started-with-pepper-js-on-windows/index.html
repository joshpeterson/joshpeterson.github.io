<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Getting started with pepper.js on Windows | Josh Peterson </title> <meta name="author" content="Josh Peterson"> <meta name="description" content="Josh's personal website "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%8B&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://joshpeterson.github.io/blog/2014/getting-started-with-pepper-js-on-windows/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Josh</span> Peterson </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/philosophy/">philosophy </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/repositories/">repositories</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/publications/">publications</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Getting started with pepper.js on Windows</h1> <p class="post-meta"> Created in August 23, 2014 </p> <p class="post-tags"> <a href="/blog/2014"> <i class="fa-solid fa-calendar fa-sm"></i> 2014 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>For some time now I’ve wanted to make my vector-based math application <a href="https://github.com/joshpeterson/osoasso" rel="external nofollow noopener" target="_blank">Osoasso</a> work with <a href="https://github.com/kripken/emscripten/wiki" rel="external nofollow noopener" target="_blank">Emscripten</a> and <a href="https://github.com/google/pepper.js" rel="external nofollow noopener" target="_blank">pepper.js</a>. Since Osoasso uses Google’s <a href="https://developer.chrome.com/native-client" rel="external nofollow noopener" target="_blank">Native Client SDK</a> to allow C++ code to execute in a browser, it is restricted to work in Google Chrome only. The pepper.js project gives the promise that the same code may work in most browsers. I’m especially interested in the performance tradeoff between C++ and JavaScript code in this case.</p> <p>This week I decided to give pepper.js a try. I’ve not yet started to compile my code, but I ran into a few problems compiling and running the examples. I wanted to write down the solutions here so that others (and I) won’t need to solve the same problems again.</p> <h2 id="getting-dependencies">Getting dependencies</h2> <h3 id="emscripten">Emscripten#</h3> <p>To use pepper.js, I first needed to install Emscripten. I was able to obtain the Emscripten SDK from <a href="http://kripken.github.io/emscripten-site/docs/getting_started/downloads.html" rel="external nofollow noopener" target="_blank">this page</a>. At the time of writing, version 1.22.0 is the latest version of the SDK. However, I’m using 32-bit Windows 7, so I had to scroll to bottom of the page and download version 1.12.0, the last version for 32-bit Windows.</p> <h3 id="windows-make">Windows make#</h3> <p>The pepper.js <a href="https://github.com/google/pepper.js/blob/master/README.rst" rel="external nofollow noopener" target="_blank">README</a> indicates the next step is to build the examples using the following command (among a few others):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make TOOLCHAIN=emscripten CONFIG=Debug
</code></pre></div></div> <p>When I initially tried this, I saw a rather odd and surprising error. As it turns out, I had the D SDK installed, so the <code class="language-plaintext highlighter-rouge">make</code> command on my machine was running the D version of <code class="language-plaintext highlighter-rouge">make</code>, not the GNU version. After moving the D verison out of the way, I downloaded the GNU Win32 version of make <a href="http://gnuwin32.sourceforge.net/packages/make.htm" rel="external nofollow noopener" target="_blank">here</a>.</p> <h2 id="spaces-in-a-path">Spaces in a path</h2> <p>When I ran the command above, I noticed the following output:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make -C ppapi
make[1]: Entering directory `C:/Users/Josh/Documents/development/pepper.js/examples/ppapi'
  CXX emscripten/debug/stub_emscripten.o
'C:\Program' is not recognized as an internal or external command, operable program or batch file.
make[1]: *** [emscripten/debug/stub_emscripten.o] Error 1
make[1]: Leaving directory `C:/Users/Josh/Documents/development/pepper.js/examples/ppapi'
make: *** [ppapi_TARGET] Error 2
</code></pre></div></div> <p>This indicates that some part of the build system is not handling the space between the words “Program” and “Files” in the path to some executable. But which executable is the problem? I’m by no means an expert in Makefile debugging, but I did find that <code class="language-plaintext highlighter-rouge">make</code> has a <code class="language-plaintext highlighter-rouge">-d</code> option, which I used. After a good bit of output, I saw this information</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Creating temporary batch file C:\Users\Josh\AppData\Local\Temp\make3560-1.bat
make[1]: Entering directory `C:/Users/Josh/Documents/development/pepper.js/examples/ppapi'
CreateProcess(C:\Users\Josh\AppData\Local\Temp\make3560-1.bat,C:\Users\Josh\AppData\Local\Temp\make3560-1.bat,...)
Putting child 0x012ada98 (emscripten/debug/stub_emscripten.o) PID 19563464 on the chain.
Live child 0x012ada98 (emscripten/debug/stub_emscripten.o) PID 19563464
  CXX emscripten/debug/stub_emscripten.o
'C:\Program' is not recognized as an internal or external command, operable program or batch file.
Reaping losing child 0x012ada98 PID 19563464
Cleaning up temp batch file C:\Users\Josh\AppData\Local\Temp\make3560-1.bat
</code></pre></div></div> <p>So it seemed likely that the file make3560-1.bat was being executed and was causing the problem. Unfortunately, that file was deleted after the error.</p> <p>Next, I used the <code class="language-plaintext highlighter-rouge">-i</code> option to cause <code class="language-plaintext highlighter-rouge">make</code> to continue after an error occurs. I was able to find a build which ran long enough so that I could view the contents of the makeXXX-1.bat file. Sure enough, the path to the Emscripten compiler was not quoted. Since Emscripten installed into the <code class="language-plaintext highlighter-rouge">C:\Program Files\Emscripten\emscripten\1.12.0</code> directory on my computer and set the <code class="language-plaintext highlighter-rouge">EMSCRIPTEN</code> environment variable to point to that directory, this problem occurred. I <a href="https://github.com/google/pepper.js/commit/15a802244ff71a6a792b8311866e86c1569358d2#diff-d41d8cd98f00b204e9800998ecf8427e" rel="external nofollow noopener" target="_blank">modified</a> the tools/nacl_emscripten.mk file to quote the paths to the Emscripten compilers, and the make command succeeded. This change has now been pulled into the pepper.js source, so it should be corrected.</p> <h2 id="building-in-release">Building in release</h2> <p>After building in debug, the README indicates that the examples should be build in release as well, using this command</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make TOOLCHAIN=emscripten CONFIG=Release
</code></pre></div></div> <p>However, something does not work correctly in the release build for many of the examples. Starting with the <code class="language-plaintext highlighter-rouge">hello_world</code> example, I see this error:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>undefined:1

^
SyntaxError: Unexpected token ILLEGAL
    at eval (native)
    at globalEval (C:\Program Files\Emscripten\emscripten\1.12.0\src\compiler.js:105:8)
    at load (C:\Program Files\Emscripten\emscripten\1.12.0\src\compiler.js:61:5)
    at Object.&lt;anonymous&gt; (C:\Program Files\Emscripten\emscripten\1.12.0\src\compiler.js:225:10)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
Traceback (most recent call last):
  File "C:\Program Files\Emscripten\emscripten\1.12.0\emscripten.py", line 1405, in &lt;module&gt;
    _main(environ=os.environ)
  File "C:\Program Files\Emscripten\emscripten\1.12.0\emscripten.py", line 1393, in _main
    temp_files.run_and_clean(lambda: main(
  File "C:\Program Files\Emscripten\emscripten\1.12.0\tools\tempfiles.py", line 39, in run_and_clean
    return func()
  File "C:\Program Files\Emscripten\emscripten\1.12.0\emscripten.py", line 1401, in &lt;lambda&gt;
    DEBUG_CACHE=DEBUG_CACHE,
  File "C:\Program Files\Emscripten\emscripten\1.12.0\emscripten.py", line 1288, in main
    jcache=jcache, temp_files=temp_files, DEBUG=DEBUG, DEBUG_CACHE=DEBUG_CACHE)
  File "C:\Program Files\Emscripten\emscripten\1.12.0\emscripten.py", line 292, in emscript
    assert len(output) == 2, 'Did not receive forwarded data in an output - process failed? We only got: ' + output[0][-3000:]
AssertionError: Did not receive forwarded data in an output - process failed? We only got:
Traceback (most recent call last):
  File "C:\Program Files\Emscripten\emscripten\1.12.0\emcc", line 1525, in &lt;module&gt;
    final = shared.Building.emscripten(final, append_ext=False, extra_args=extra_args)
  File "C:\Program Files\Emscripten\emscripten\1.12.0\tools\shared.py", line 1276, in emscripten
    assert os.path.exists(filename + '.o.js') and len(open(filename + '.o.js', 'r').read()) &gt; 0, 'Emscripten failed to generate .js: ' + str(compiler_output)
AssertionError: Emscripten failed to generate .js:
make[1]: *** [emscripten/Release/hello_world_unstripped.js] Error 1
make[1]: Leaving directory `C:/Users/Josh/Documents/development/pepper.js/examples/hello_world'
make: *** [hello_world_TARGET] Error 2
</code></pre></div></div> <p>I’m not sure about the cause of this problem, but it may be similar to this <a href="https://github.com/google/pepper.js/issues/8" rel="external nofollow noopener" target="_blank">issue</a> reported recently. In spite of this problem, we can still verify that the debug build of the examples worked.</p> <p><strong>Update 2014-08-26:</strong> I was able to work around the problem above by using the command line:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make TOOLCHAIN=emscripten CONFIG=release
</code></pre></div></div> <p>Note that the “r” in “release” is lowercase instead of uppercase. It seems this problem is not the same as the issue I linked to above. This change does correct the problem and allow the release build of the examples to complete for me though.</p> <h2 id="testing-the-debug-examples">Testing the debug examples</h2> <p>After running the local web server to test the examples, I found that none of them were working! This occurs because the website uses the release build of the examples, which is not available. It is relatively easy to use the debug build of the example though. First, select the “Developer Mode” option near the bottom of the examples site:</p> <p><img src="/static/images/getting-started-with-pepper-js-on-windows/select-debug.png" alt="Select developer mode"></p> <p>This will enable a “Config” section of the site, which will allow you to switch to the debug build, where the examples should work.</p> <p><img src="/static/images/getting-started-with-pepper-js-on-windows/use-debug.png" alt="Use debug configuration"></p> <h2 id="conclusion">Conclusion</h2> <p>With these few tweaks, I was able to get the pepper.js examples working well on Windows. The next step is to build my project!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/more-fun-with-loop-unrolling-cpp/">More fun with loop unrolling - C++</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/learning-loop-unrolling/">Learning loop unrolling</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/constraints-are-liberating/">Constraints are liberating</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/span-making-c-arrays-fun-since-2020/">Span - making C arrays fun since 2020</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/game-theory-fun-in-the-nfl/">Game theory fun in the NFL</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Josh Peterson. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: March 16, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>